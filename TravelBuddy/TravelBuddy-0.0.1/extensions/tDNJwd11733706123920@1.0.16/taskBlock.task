{"componentModelEntities":{"MAIN_COMPONENT":{"id":"MAIN_COMPONENT","type":"main","label":"メインプロセス","version":"0.0.0.0","args0":[{"name":"statements","type":"input_statement","value":["d8qQ5"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"enableComment":false},"d8qQ5":{"id":"d8qQ5","type":"base_command_custom","label":"コードの挿入","version":"0.0.0.0","args0":[{"name":"describe","value":"\"date_format\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"code","value":"import re\r\nfrom datetime import datetime\r\nimport unicodedata\r\n\r\n# Function to normalize the input date to half-width characters\r\ndef normalize_to_halfwidth(input_date):\r\n    return unicodedata.normalize('NFKC', input_date)\r\n\r\n# Function to convert 和暦 to Gregorian calendar\r\ndef convert_to_gregorian(calendar_era, current_date):\r\n    # Normalize input to half-width characters\r\n    current_date = normalize_to_halfwidth(current_date)\r\n    \r\n    if calendar_era == \"西暦\":\r\n        # Match both formats: YYYY-MM-DD, YYYY/MM/DD, YYYY.MM.DD, or YYYY年M月D日\r\n        match = re.search(r'(\\d{4})[-/\\.](\\d{1,2})[-/\\.](\\d{1,2})|(\\d{4})年(\\d{1,2})月(\\d{1,2})日', current_date)\r\n        if match:\r\n            # Extract the date components (group 1, 2, 3 or group 4, 5, 6)\r\n            year = int(match.group(1) or match.group(4))\r\n            month = int(match.group(2) or match.group(5))\r\n            day = int(match.group(3) or match.group(6))\r\n            intermediate_date = f\"{year}/{month:02d}/{day:02d}\"\r\n            return intermediate_date\r\n    elif calendar_era == \"和暦\":\r\n        # Define mappings of Japanese eras to Gregorian starting years\r\n        era_map = {\r\n            \"令和\": 2018,  # Reiwa era started in 2019\r\n            \"平成\": 1988,  # Heisei era started in 1989\r\n            \"昭和\": 1925,  # Showa era started in 1926\r\n            \"大正\": 1911,  # Taisho era started in 1912\r\n            \"明治\": 1867   # Meiji era started in 1868\r\n        }\r\n\r\n        # Match 和暦 format\r\n        match = re.search(r'([^\\d]+)(\\d+)年\\s*(\\d{1,2})月\\s*(\\d{1,2})日', current_date)\r\n        if match:\r\n            era = match.group(1)  # Era name (e.g., 令和)\r\n            year = int(match.group(2))  # Year in the era (e.g., 6)\r\n            month = int(match.group(3))  # Month (e.g., 12)\r\n            day = int(match.group(4))  # Day (e.g., 9)\r\n\r\n            if era in era_map:\r\n                # Convert 和暦 year to Gregorian year\r\n                gregorian_year = era_map[era] + year\r\n                intermediate_date = f\"{gregorian_year}/{month:02d}/{day:02d}\"\r\n                return intermediate_date\r\n        else:\r\n            raise ValueError(f\"Invalid 和暦 date format: {current_date}\")\r\n\r\n    raise ValueError(f\"Unsupported calendar era: {calendar_era}\")\r\n\r\n# Function to apply the desired date format\r\ndef change_date_format(intermediate_date, date_format):\r\n    # Extract year, month, and day from the Gregorian date\r\n    match = re.search(r'(\\d{4})/(\\d{2})/(\\d{2})', intermediate_date)\r\n    if match:\r\n        year = int(match.group(1))\r\n        month = int(match.group(2))\r\n        day = int(match.group(3))\r\n\r\n        # Handle the date_format logic \r\n        if date_format == \"YYYY-MM-DD\" and day:\r\n            return f\"{year}-{month:02d}-{day:02d}\"\r\n        elif date_format == \"YYYY/MM/DD\" and day:\r\n            return f\"{year}/{month:02d}/{day:02d}\"\r\n        elif date_format == \"YYYY.MM.DD\" and day:\r\n            return f\"{year}.{month:02d}.{day:02d}\"\r\n        elif date_format == \"YYYY年MM月DD日\" and day:\r\n            return f\"{year}年{month:02d}月{day:02d}日\"\r\n        elif date_format == \"YYYY-M-D\" and day:\r\n            return f\"{year}-{month}-{day}\"\r\n        elif date_format == \"YYYY/M/D\" and day:\r\n            return f\"{year}/{month}/{day}\"\r\n        elif date_format == \"YYYY.M.D\" and day:\r\n            return f\"{year}.{month}.{day}\"\r\n        elif date_format == \"YYYY年M月D日\" and day:\r\n            return f\"{year}年{month}月{day}日\"\r\n        elif date_format == \"YYYY-MM\":\r\n            return f\"{year}-{month:02d}\"\r\n        elif date_format == \"MM-DD\" and day:\r\n            return f\"{month:02d}-{day:02d}\"\r\n        elif date_format == \"YYYY/MM\":\r\n            return f\"{year}/{month:02d}\"\r\n        elif date_format == \"MM/DD\" and day:\r\n            return f\"{month:02d}/{day:02d}\"\r\n        elif date_format == \"YYYY.MM\":\r\n            return f\"{year}.{month:02d}\"\r\n        elif date_format == \"MM.DD\" and day:\r\n            return f\"{month:02d}.{day:02d}\"\r\n        elif date_format == \"YYYY年MM月\":\r\n            return f\"{year}年{month:02d}月\"\r\n        elif date_format == \"MM月DD日\" and day:\r\n            return f\"{month:02d}月{day:02d}日\"\r\n        elif date_format == \"YYYY-M\":\r\n            return f\"{year}-{month}\"\r\n        elif date_format == \"M-D\" and day:\r\n            return f\"{month}-{day}\"\r\n        elif date_format == \"YYYY/M\":\r\n            return f\"{year}/{month}\"\r\n        elif date_format == \"M/D\" and day:\r\n            return f\"{month}/{day}\"\r\n        elif date_format == \"YYYY.M\":\r\n            return f\"{year}.{month}\"\r\n        elif date_format == \"M.D\" and day:\r\n            return f\"{month}.{day}\"\r\n        elif date_format == \"YYYY年M月\":\r\n            return f\"{year}年{month}月\"\r\n        elif date_format == \"M月D日\" and day:\r\n            return f\"{month}月{day}日\"\r\n        elif date_format == \"YYYY\":\r\n            return f\"{year}\"\r\n        elif date_format == \"YYYY年\":\r\n            return f\"{year}年\"\r\n        elif date_format == \"MM\":\r\n            return f\"{month:02d}\"\r\n        elif date_format == \"MM月\":\r\n            return f\"{month:02d}月\"\r\n        elif date_format == \"DD\" and day:\r\n            return f\"{day:02d}\"\r\n        elif date_format == \"DD日\" and day:\r\n            return f\"{day:02d}日\"\r\n        elif date_format == \"M\":\r\n            return f\"{month}\"\r\n        elif date_format == \"M月\":\r\n            return f\"{month}月\"\r\n        elif date_format == \"D\" and day:\r\n            return f\"{day}\"\r\n        elif date_format == \"D日\" and day:\r\n            return f\"{day}日\"\r\n        elif date_format == \"令和Y年MM月DD日\" and day:\r\n            era_year = year - 2018\r\n            return f\"令和{era_year}年{month:02d}月{day:02d}日\"\r\n        elif date_format == \"令和Y年M月D日\" and day:\r\n            era_year = year - 2018\r\n            return f\"令和{era_year}年{month}月{day}日\"\r\n        elif date_format == \"令和Y年\" and day:\r\n            era_year = year - 2018\r\n            return f\"令和{era_year}年\"\r\n        elif date_format == \"令和Y年MM月\" and day:\r\n            era_year = year - 2018 \r\n            return f\"令和{era_year}年{month:02d}月\"\r\n        elif date_format == \"令和Y年M月\" and day:\r\n            era_year = year - 2018 \r\n            return f\"令和{era_year}年{month}月\"\r\n    else:\r\n        raise ValueError(f\"Invalid Gregorian date format: {intermediate_date}\")\r\n\r\n# Convert 和暦 to Gregorian\r\nintermediate_date = convert_to_gregorian(calendar_era, current_date)\r\n\r\n# Change the format to the desired format\r\nchanged_date = change_date_format(intermediate_date, date_format)\r\n","valueMode":"expression","displayType":"code","displayParam":{"mode":"python"}}],"enableComment":false}},"dataTag":1}