{"componentModelEntities":{"31963":{"id":"31963","type":"TASK_COMPONENT_0v1GWCU1733892918740","label":"ログ出力","version":"1.0.2","args0":[{"name":"log_label","value":"\"【開始】\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"log_message","value":"\"RPA作業\"","valueMode":"text","displayType":"text","displayParam":{}}],"enableComment":false},"MAIN_COMPONENT":{"id":"MAIN_COMPONENT","type":"main","label":"主流程","version":"0.0.0.0","args0":[{"name":"statements","type":"input_statement","value":["kIBNF","BoZal","Uawmb","31963"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"enableComment":false},"kIBNF":{"id":"kIBNF","type":"logic_control_try_catch","label":"エラーキャッチ（try catch）","version":"0.0.0.0","args0":[{"name":"try_fn","type":"input_statement","value":["j9Nxt","ccbDI","2T7dW","L9RMY"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"args1":[{"name":"except_fn","type":"input_statement","value":["DHGdR","HA0Q4","BsZ5u","60nAs"]},{"name":"is_fold_state_1","displayType":"hidden","value":0}],"args2":[{"name":"else_fn","type":"input_statement","value":[]},{"name":"is_fold_state_2","displayType":"hidden","value":0}],"enableComment":false},"j9Nxt":{"id":"j9Nxt","type":"base_command_custom","label":"コードの挿入","version":"0.0.0.0","args0":[{"name":"describe","value":"\"定数Excel取込\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"code","value":"#定数excelのすべてのシートを取り込み\n#sheet_name シート名指定\n#header = 0 (1行目がヘッダーになる)\n#keep_default_na = False (空欄の要素をNaNとして扱う)\nimport pandas as pd\nimport os\ndf = pd.read_excel(os.path.join(self.root,\"conf\",\"config.xlsx\"), sheet_name=\"Sheet1\", header = 0, keep_default_na = False)","displayType":"code","displayParam":{"mode":"python"}}],"enableComment":false},"ccbDI":{"id":"ccbDI","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.7","args0":[{"name":"var_name","value":"configs","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"{}","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"2T7dW":{"id":"2T7dW","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"G_SystemException","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"None","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"L9RMY":{"id":"L9RMY","type":"logic_control_array_for","label":"リスト走査 (for-in)","version":"0.0.0.0","args0":[{"name":"array_value","value":"row","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"array_name","value":"df.itertuples()","valueMode":"expression","displayType":"text","displayParam":{}}],"args1":[{"name":"array_for_fn","type":"input_statement","value":["lL2Tc","pCEE2","kAhLR"]},{"name":"is_fold_state_0","displayType":"hidden","value":1}],"enableComment":false},"lL2Tc":{"id":"lL2Tc","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"key","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"str(row.key).strip()","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"pCEE2":{"id":"pCEE2","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"value","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"str(row.value).strip()","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"kAhLR":{"id":"kAhLR","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"configs[key]","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"value","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"DHGdR":{"id":"DHGdR","type":"base_command_custom","label":"コードの挿入","version":"0.0.0.0","args0":[{"name":"describe","value":"\"例外エラーメッセージ取得\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"code","value":"import traceback\nimport re \nerr_msg = traceback.format_exc(limit=3)\nele_ids = re.findall(r'SHIZAI_ELEMENT_DICT\\[\"(.*?)\"\\]', f' {MSG_Error}')\nele_name = \"\"\nif ele_ids:\n    ele_name = SHIZAI_ELEMENT_DICT.get(ele_ids[-1], {}).get('name')","displayType":"code","displayParam":{"mode":"python"}}],"enableComment":false},"HA0Q4":{"id":"HA0Q4","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"G_SystemException","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"MSG_Error","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"BsZ5u":{"id":"BsZ5u","type":"Log_Error","label":"エラーログの印刷","version":"2.8.0.1","args0":[{"name":"msg","value":"G_SystemException","valueMode":"expression","displayType":"logInput","displayParam":{}}],"enableComment":false},"60nAs":{"id":"60nAs","type":"Time_GetDateV2","label":"取得日時","version":"2.8.0.1","args0":[{"name":"var_name","value":"error_time","valueMode":"expression"},{"name":"time_data","value":"1"}],"options0":[{"name":"var_ret","value":"0"},{"name":"skip_err","value":"0"},{"name":"delay_before","value":"0"},{"name":"delay_after","value":"0"}],"enableComment":false},"BoZal":{"id":"BoZal","type":"Time_GetDateV2","label":"取得日時","version":"2.8.0.3","args0":[{"name":"var_name","value":"today","valueMode":"expression"},{"name":"time_data","value":"1"}],"options0":[{"name":"var_ret","value":"0"},{"name":"skip_err","value":"0"},{"name":"delay_before","value":"0"},{"name":"delay_after","value":"0"}],"enableComment":false},"Uawmb":{"id":"Uawmb","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.3","args0":[{"name":"var_name","value":"Log_path","valueMode":"expression"},{"name":"value","value":"configs[\"log_path\"] + today.replace(\"-\",\"\").replace(\":\",\"\").replace(\" \", \"\") + \".log\"","valueMode":"expression"}],"options0":[{"name":"var_ret","value":"0"}],"enableComment":false}},"dataTag":1}