{"componentModelEntities":{"MAIN_COMPONENT":{"id":"MAIN_COMPONENT","type":"main","label":"主流程","version":"0.0.0.0","args0":[{"name":"statements","type":"input_statement","value":["CuHBQ","qyarN","AnQ9L"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"enableComment":false},"CuHBQ":{"id":"CuHBQ","type":"logic_control_try_catch","label":"エラーキャッチ（try catch）","version":"0.0.0.0","args0":[{"name":"try_fn","type":"input_statement","value":["sQbKP","5SAqg","BmXPW","WDwnQ"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"args1":[{"name":"except_fn","type":"input_statement","value":["4kANQ","23TIf","ag42F","ScdbJ"]},{"name":"is_fold_state_1","displayType":"hidden","value":0}],"args2":[{"name":"else_fn","type":"input_statement","value":[]},{"name":"is_fold_state_2","displayType":"hidden","value":0}],"enableComment":false},"sQbKP":{"id":"sQbKP","type":"base_command_custom","label":"コードの挿入","version":"0.0.0.0","args0":[{"name":"describe","value":"\"定数Excel取込\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"code","value":"#定数excelのすべてのシートを取り込み\n#sheet_name シート名指定\n#header = 0 (1行目がヘッダーになる)\n#keep_default_na = False (空欄の要素をNaNとして扱う)\nimport pandas as pd\nimport os\ndf = pd.read_excel(os.path.join(self.root,\"conf\",\"config.xlsx\"), sheet_name=\"Sheet1\", header = 0, keep_default_na = False)","displayType":"code","displayParam":{"mode":"python"}}],"enableComment":false},"5SAqg":{"id":"5SAqg","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.7","args0":[{"name":"var_name","value":"configs","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"{}","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"BmXPW":{"id":"BmXPW","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"G_SystemException","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"None","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"WDwnQ":{"id":"WDwnQ","type":"logic_control_array_for","label":"リスト走査 (for-in)","version":"0.0.0.0","args0":[{"name":"array_value","value":"row","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"array_name","value":"df.itertuples()","valueMode":"expression","displayType":"text","displayParam":{}}],"args1":[{"name":"array_for_fn","type":"input_statement","value":["zFcMw","nDHgE","ZA1IM"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"enableComment":false},"zFcMw":{"id":"zFcMw","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"key","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"str(row.key).strip()","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"nDHgE":{"id":"nDHgE","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"value","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"str(row.value).strip()","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"ZA1IM":{"id":"ZA1IM","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"configs[key]","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"value","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"4kANQ":{"id":"4kANQ","type":"base_command_custom","label":"コードの挿入","version":"0.0.0.0","args0":[{"name":"describe","value":"\"例外エラーメッセージ取得\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"code","value":"import traceback\nimport re \nerr_msg = traceback.format_exc(limit=3)\nele_ids = re.findall(r'SHIZAI_ELEMENT_DICT\\[\"(.*?)\"\\]', f' {MSG_Error}')\nele_name = \"\"\nif ele_ids:\n    ele_name = SHIZAI_ELEMENT_DICT.get(ele_ids[-1], {}).get('name')","displayType":"code","displayParam":{"mode":"python"}}],"enableComment":false},"23TIf":{"id":"23TIf","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"G_SystemException","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"MSG_Error","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"ag42F":{"id":"ag42F","type":"Log_Error","label":"エラーログの印刷","version":"2.8.0.1","args0":[{"name":"msg","value":"G_SystemException","valueMode":"expression","displayType":"logInput","displayParam":{}}],"enableComment":false},"ScdbJ":{"id":"ScdbJ","type":"Time_GetDateV2","label":"取得日時","version":"2.8.0.1","args0":[{"name":"var_name","value":"error_time","valueMode":"expression"},{"name":"time_data","value":"1"}],"options0":[{"name":"var_ret","value":"0"},{"name":"skip_err","value":"0"},{"name":"delay_before","value":"0"},{"name":"delay_after","value":"0"}],"enableComment":false},"qyarN":{"id":"qyarN","type":"Time_GetDateV2","label":"取得日時","version":"2.8.0.3","args0":[{"name":"var_name","value":"today","valueMode":"expression"},{"name":"time_data","value":"1"}],"options0":[{"name":"var_ret","value":"0"},{"name":"skip_err","value":"0"},{"name":"delay_before","value":"0"},{"name":"delay_after","value":"0"}],"enableComment":false},"AnQ9L":{"id":"AnQ9L","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.3","args0":[{"name":"var_name","value":"Log_path","valueMode":"expression"},{"name":"value","value":"configs[\"log_path\"] + today.replace(\"-\",\"\").replace(\":\",\"\").replace(\" \", \"\") + \".log\"","valueMode":"expression"}],"options0":[{"name":"var_ret","value":"0"}],"enableComment":false}},"dataTag":1}