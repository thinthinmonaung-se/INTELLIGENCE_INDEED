{"componentModelEntities":{"MAIN_COMPONENT":{"id":"MAIN_COMPONENT","type":"main","label":"主流程","version":"0.0.0.0","args0":[{"name":"statements","type":"input_statement","value":["dtC07","i81sK","K2R6J","Bhn2n","brpUs","XclXt","JG3MO","iSIkB"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"enableComment":false},"dtC07":{"id":"dtC07","type":"logic_control_try_catch","label":"エラーキャッチ（try catch）","version":"0.0.0.0","args0":[{"name":"try_fn","type":"input_statement","value":["vzM7v","kXP5g","Cggbm","Eq51i"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"args1":[{"name":"except_fn","type":"input_statement","value":["NQQOy","tGa7y","91RX0","f0qaj"]},{"name":"is_fold_state_1","displayType":"hidden","value":0}],"args2":[{"name":"else_fn","type":"input_statement","value":[]},{"name":"is_fold_state_2","displayType":"hidden","value":0}],"enableComment":false},"vzM7v":{"id":"vzM7v","type":"base_command_custom","label":"コードの挿入","version":"0.0.0.0","args0":[{"name":"describe","value":"\"定数Excel取込\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"code","value":"#定数excelのすべてのシートを取り込み\n#sheet_name シート名指定\n#header = 0 (1行目がヘッダーになる)\n#keep_default_na = False (空欄の要素をNaNとして扱う)\nimport pandas as pd\nimport os\ndf = pd.read_excel(os.path.join(self.root,\"conf\",\"config.xlsx\"), sheet_name=\"Sheet1\", header = 0, keep_default_na = False)","displayType":"code","displayParam":{"mode":"python"}}],"enableComment":false},"kXP5g":{"id":"kXP5g","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.7","args0":[{"name":"var_name","value":"configs","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"{}","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"Cggbm":{"id":"Cggbm","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"G_SystemException","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"None","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"Eq51i":{"id":"Eq51i","type":"logic_control_array_for","label":"リスト走査 (for-in)","version":"0.0.0.0","args0":[{"name":"array_value","value":"row","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"array_name","value":"df.itertuples()","valueMode":"expression","displayType":"text","displayParam":{}}],"args1":[{"name":"array_for_fn","type":"input_statement","value":["ZFmYv","82C6r","HyjSS"]},{"name":"is_fold_state_0","displayType":"hidden","value":0}],"enableComment":false},"ZFmYv":{"id":"ZFmYv","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"key","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"str(row.key).strip()","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"82C6r":{"id":"82C6r","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"value","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"str(row.value).strip()","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"HyjSS":{"id":"HyjSS","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"configs[key]","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"value","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"NQQOy":{"id":"NQQOy","type":"base_command_custom","label":"コードの挿入","version":"0.0.0.0","args0":[{"name":"describe","value":"\"例外エラーメッセージ取得\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"code","value":"import traceback\nimport re \nerr_msg = traceback.format_exc(limit=3)\nele_ids = re.findall(r'SHIZAI_ELEMENT_DICT\\[\"(.*?)\"\\]', f' {MSG_Error}')\nele_name = \"\"\nif ele_ids:\n    ele_name = SHIZAI_ELEMENT_DICT.get(ele_ids[-1], {}).get('name')","displayType":"code","displayParam":{"mode":"python"}}],"enableComment":false},"tGa7y":{"id":"tGa7y","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.1","args0":[{"name":"var_name","value":"G_SystemException","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"MSG_Error","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false},"91RX0":{"id":"91RX0","type":"Log_Error","label":"エラーログの印刷","version":"2.8.0.1","args0":[{"name":"msg","value":"G_SystemException","valueMode":"expression","displayType":"logInput","displayParam":{}}],"enableComment":false},"f0qaj":{"id":"f0qaj","type":"Time_GetDateV2","label":"取得日時","version":"2.8.0.1","args0":[{"name":"var_name","value":"error_time","valueMode":"expression"},{"name":"time_data","value":"1"}],"options0":[{"name":"var_ret","value":"0"},{"name":"skip_err","value":"0"},{"name":"delay_before","value":"0"},{"name":"delay_after","value":"0"}],"enableComment":false},"i81sK":{"id":"i81sK","type":"Time_GetDateV2","label":"取得日時","version":"2.8.0.3","args0":[{"name":"var_name","value":"today","valueMode":"expression"},{"name":"time_data","value":"1"}],"options0":[{"name":"var_ret","value":"0"},{"name":"skip_err","value":"0"},{"name":"delay_before","value":"0"},{"name":"delay_after","value":"0"}],"enableComment":false},"K2R6J":{"id":"K2R6J","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.3","args0":[{"name":"var_name","value":"Log_path","valueMode":"expression"},{"name":"value","value":"configs[\"log_path\"] + today.replace(\"-\",\"\").replace(\":\",\"\").replace(\" \", \"\") + \".log\"","valueMode":"expression"}],"options0":[{"name":"var_ret","value":"0"}],"enableComment":false},"Bhn2n":{"id":"Bhn2n","type":"TASK_COMPONENT_0v1GWCU1733892918740","label":"ログ出力","version":"1.0.2","args0":[{"name":"log_label","value":"\"【開始】\"","valueMode":"text"},{"name":"log_message","value":"'RPA作業\\n' + '=============================================================================================='","valueMode":"expression"}],"enableComment":false},"brpUs":{"id":"brpUs","type":"File_GetFileList","label":"ファイルリストを取得","version":"2.8.0.8","args0":[{"name":"var_name","value":"list","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"folder_path","value":"\"C:\\\\Python Learning\\\\Project\\\\PDFDataScraping\\\\invoices\"","displayType":"selectFile","displayParam":{"properties":["openDirectory"]}},{"name":"key_word","value":"\"Invoice\"","valueMode":"text","displayType":"text","displayParam":{}},{"name":"ignore","value":"\"\"","displayType":"text","displayParam":{}},{"name":"recursive","value":"0","displayType":"checkbox","displayParam":{"text":"サブフォルダを検索"}},{"name":"is_full_path","value":"1","displayType":"checkbox","displayParam":{"text":"フルパスを取得"}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}},{"name":"skip_err","value":"0","displayType":"radioGroup","displayParam":[{"label":"はい","value":"1"},{"label":"いいえ","value":"0"}]},{"name":"delay_before","value":"0","displayType":"text","displayParam":{}},{"name":"delay_after","value":"0","displayType":"text","displayParam":{}}],"enableComment":false},"XclXt":{"id":"XclXt","type":"base_command_custom","label":"コードの挿入","version":"0.0.0.0","args0":[{"name":"describe","value":"\"file順番\"","valueMode":"text","displayType":"text","displayParam":{},"wrapperType":[],"wrapperParam":[]},{"name":"code","value":"import re\n\n# Sort the file list based on the numeric part of the filename\nfile_list = sorted(list, key=lambda f: int(re.search(r\"Invoice (\\d+)\\.pdf\", f).group(1)))","valueMode":"expression","displayType":"code","displayParam":{"mode":"python"},"wrapperType":[],"wrapperParam":[]}],"enableComment":false},"JG3MO":{"id":"JG3MO","type":"Excel_Cs_OpenV3","label":"Excelを開く","version":"2.8.0.8","args0":[{"name":"var_name","value":"excel","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"file","value":"\"C:\\\\Python Learning\\\\Project\\\\PDFDataScraping\\\\ScrapedInvoiceOutput.xlsx\"","displayType":"selectFile","displayParam":{"filters":[{"extensions":["xls","xlsx","et","ett","xlt","xlsm"],"name":"Excel"}]}},{"name":"visible","value":"1","displayType":"checkbox","displayParam":{"text":"ソフトウェアを使用"}},{"name":"software","value":"\"MicrosoftExcel\"","displayType":"dropDownSelect","displayParam":[{"label":"デフォルトのソフトウェア","value":"\"默认\""},{"label":"Microsoft Office","value":"\"MicrosoftExcel\""},{"label":"WPS Office","value":"\"WPS\""}],"wrapperType":["dependencyShow"],"wrapperParam":[{"visible":["1"]}]},{"name":"show","value":"1","displayType":"checkbox","displayParam":{"text":"可視化"},"wrapperType":["dependencyShow"],"wrapperParam":[{"visible":["1"]}]},{"name":"maximize","value":"1","displayType":"checkbox","displayParam":{"text":"最大化"},"wrapperType":["dependencyShow"],"wrapperParam":[{"visible":["1"]}]},{"name":"password1","value":"\"\"","displayType":"encryption","displayParam":{"encrypt":"true"}},{"name":"password2","value":"\"\"","displayType":"encryption","displayParam":{"encrypt":"true"}},{"name":"share","value":"0","displayType":"checkbox","displayParam":{"text":"パスを共有"}},{"name":"autoUpdateLink","value":"0","displayType":"checkbox","displayParam":{"text":"外部リンクを自動更新"}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}},{"name":"skip_err","value":"0","displayType":"radioGroup","displayParam":[{"label":"はい","value":"1"},{"label":"いいえ","value":"0"}]},{"name":"delay_before","value":"0","displayType":"text","displayParam":{}},{"name":"delay_after","value":"0","displayType":"text","displayParam":{}}],"enableComment":false},"iSIkB":{"id":"iSIkB","type":"Basic_SetVariable","label":"変数設定","version":"2.8.0.8","args0":[{"name":"var_name","value":"row","valueMode":"expression","displayType":"text","displayParam":{}},{"name":"value","value":"2","valueMode":"expression","displayType":"comboSelector","displayParam":{"elementTypes":["normal","cv"]}}],"options0":[{"name":"var_ret","value":"0","displayType":"checkbox","displayParam":{"text":"コンポーネントの出力変数値を出力"}}],"enableComment":false}},"dataTag":1}